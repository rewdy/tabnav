/*
 * TabNav - plug in to notify users of leaving your site
 * Version: 1.0 (09/21/2010)
 * Copyright (c) 2010 Andrew Meyer
 * Licensed under the MIT License: http://en.wikipedia.org/wiki/MIT_License
 * Requires: jQuery v1.2+
*/

(function(jQuery){var methods={init:function(opt){var defaults={handle:"h3",tn_class:"tabnav_list",tn_id:"tabnav_list",tn_position:"before",active_class:"current",start_open_index:0,tabarea_class:'tabnav_tab_area'};options=jQuery.extend(defaults,opt);var loc=window.location.href;var tabnavHtml='<ul id="'+options.tn_id+'" class="'+options.tn_class+'"></ul>';if(options.tn_position=="before"){jQuery(this).first().before(tabnavHtml);}else if(options.tn_position=="after"){jQuery(this).last().after(tabnavHtml);}else{jQuery(options.tn_position).append(tabnavHtml);}
var tabnav=jQuery("#"+options.tn_id);if(jQuery().hashchange){jQuery(window).hashchange(function(){var hash_process=window.location.hash.replace('/',"");showtab(jQuery(hash_process));});}
return this.each(function(index){var el=jQuery(this);var handle=el.find(options.handle);var handleText=handle.text()!=""?handle.text():"Tab "+index;el.addClass(options.tabarea_class);if(el.attr('id')==""){var this_id=handleText.replace(/ /g,"_").replace(/(\&|\$|\%|\?)/g,"");el.attr('id',this_id);}else{this_id=el.attr('id');}
element_listitem_id_prefix="tn_link_item_";var element_link_html='<li id="'+element_listitem_id_prefix+this_id+'"><a href="#/'+this_id+'">'+handleText+'</a></li>';tabnav.append(element_link_html);jQuery("#tn_link_item_"+this_id).click(function(){var target_obj=jQuery('#'+this_id);showtab(target_obj);});if(!window.location.hash){if(index!=options.start_open_index){el.hide();}
tabnav.find('li').eq(options.start_open_index).addClass(options.active_class);}else if(window.location.hash){var hash_process=window.location.hash.replace('/',"");if(this_id==hash_process.replace("#","")){showtab(jQuery(hash_process));}}});},show:function(){alert('show!');}}
jQuery.fn.tabnav=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1));}else if(typeof method==='object'||!method){return methods.init.apply(this,arguments);}else{$.error('Method '+method+' does not exist on jQuery.tabnav');}};function showtab(which){which.show().siblings('div').hide();var link_selector="#"+element_listitem_id_prefix+which.attr('id');jQuery(link_selector).addClass(options.active_class).siblings('li').removeClass(options.active_class);}})(jQuery);